(function(){"use strict";var t={8256:function(t,e,n){var r=n(9242),o=n(3396),i=n(7139);const a={class:"container"},c={class:"row"},l=(0,o._)("div",{class:"col col-sm-9"},[(0,o._)("h1",null,"Site")],-1),s={class:"col col-sm-3"},u={class:"alert alert-default"},d=(0,o._)("hr",null,null,-1),p={class:"wrapper"},m={class:"flex-row"},v={class:"flex-col-menu"},h={class:"menu-list"},f=["onClick"],_={class:"flex-col-prod"};function w(t,e,n,r,w,k){const g=(0,o.up)("router-link"),b=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("header",null,[(0,o._)("div",a,[(0,o._)("div",c,[l,(0,o._)("div",s,[(0,o._)("div",u,[(0,o._)("div",null,"In Cart: "+(0,i.zw)(t.$store.getters["cart/length"]),1),(0,o._)("div",null,"Total: "+(0,i.zw)(t.$store.getters["cart/total"]),1)])])]),d])]),(0,o._)("section",null,[(0,o._)("div",p,[(0,o._)("div",m,[(0,o._)("div",v,[(0,o._)("ul",h,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.menu,(t=>((0,o.wg)(),(0,o.iD)("li",{class:(0,i.C_)(k.activeClass(t.route)),key:t.route,onClick:e=>k.makeActive(t.route)},[(0,o.Wm)(g,{to:{name:t.route},class:"router"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(t.text),1)])),_:2},1032,["to"])],10,f)))),128))])]),(0,o._)("div",_,[(0,o._)("div",null,[(0,o.Wm)(b)])])])])])])}var k={data:()=>({menu:[{route:"catalog",text:"Products"},{route:"cart",text:"Cart"},{route:"checkout",text:"Order"}],active:"catalog"}),methods:{makeActive:function(t){this.active=t},activeClass(t){if(t===this.active)return this.active=t}}},g=n(89);const b=(0,g.Z)(k,[["render",w]]);var C=b,y=n(9749),D={namespaced:!0,state:{items:[]},getters:{all:t=>t.items,one:t=>e=>t.items.find((t=>t.id===e))},mutations:{setItems(t,e){t.items=e}},actions:{async load({commit:t}){let e=await fetch("http://faceprog.ru/reactcourseapi/products/all.php"),n=await e.json();t("setItems",n)}}};const O="http://faceprog.ru/reactcourseapi/cart/";var x={namespaced:!0,state:{items:[],token:null},getters:{inCart:t=>e=>t.items.some((t=>t.id==e)),itemsDetailed:(t,e,n,r)=>t.items.map((t=>{let e=r["products/one"](t.id);return{...e,cnt:t.cnt}})),length:t=>t.items.length,total:(t,e)=>e.itemsDetailed.reduce(((t,e)=>t+e.price*e.cnt),0)},mutations:{load(t,{cart:e,token:n}){t.items=e,t.token=n},add(t,e){t.items.push({id:e,cnt:1})},remove(t,e){t.items=t.items.filter((t=>t.id!=e))},setCnt(t,{id:e,cnt:n}){let r=t.items.find((t=>t.id==e));r.cnt=n}},actions:{async load({commit:t}){let e=localStorage.getItem("CART__TOKEN"),n=await fetch(`${O}load.php?token=${e}`),{cart:r,token:o,needUpdate:i}=await n.json();i&&localStorage.setItem("CART__TOKEN",o),t("load",{cart:r,token:o})},async add({commit:t,getters:e,state:n},r){if(!e.inCart(r)){let e=await fetch(`${O}add.php?token=${n.token}&id=${r}`),o=await e.json();o&&t("add",r)}},async remove({commit:t,getters:e,state:n},r){if(e.inCart(r)){let e=await fetch(`${O}remove.php?token=${n.token}&id=${r}`),o=await e.json();o&&t("remove",r)}},setCnt({commit:t,getters:e},{id:n,cnt:r}){if(e.inCart(n)){let o=e.itemsDetailed.find((t=>t.id==n)),i=Math.min(Math.max(r,1),o.rest);t("setCnt",{id:n,cnt:i})}}}};const $={modules:{products:D,cart:x},strict:!1};var j=(0,y.MT)($),z=n(678);const I=t=>((0,o.dD)("data-v-1887464e"),t=t(),(0,o.Cn)(),t),T=I((()=>(0,o._)("h1",null,"Products",-1))),P={class:"row"},S={class:"card"},A={class:"card-body"},U=(0,o.Uk)("Read more"),Z=I((()=>(0,o._)("hr",null,null,-1))),K=["onClick"],E=["onClick"];function M(t,e,n,r,a,c){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[T,(0,o._)("div",P,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.productList,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"col col-sm-4 mb-3 mt-3",key:e.id},[(0,o._)("div",S,[(0,o._)("div",A,[(0,o._)("h3",null,(0,i.zw)(e.title),1),(0,o._)("div",null,(0,i.zw)(e.price),1),(0,o.Wm)(l,{to:{name:"product",params:{id:e.id}}},{default:(0,o.w5)((()=>[U])),_:2},1032,["to"]),Z,t.inCart(e.id)?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:n=>t.remove(e.id),type:"button",class:"btn btn-danger"}," Remove ",8,K)):((0,o.wg)(),(0,o.iD)("button",{key:1,onClick:n=>t.add(e.id),type:"button",class:"btn btn-success"}," Add to cart ",8,E))])])])))),128))])])}var R={computed:{...(0,y.Se)("products",{productList:"all"}),...(0,y.Se)("cart",["inCart"])},methods:{...(0,y.nv)("cart",["add","remove"])}};const W=(0,g.Z)(R,[["render",M],["__scopeId","data-v-1887464e"]]);var B=W;const H={key:0},Y=(0,o.Uk)(" Back to products "),L=(0,o._)("hr",null,null,-1),N={class:"alert alert-success"};function F(t,e,n,r,a,c){const l=(0,o.up)("app-e-404");return c.hasProduct?((0,o.wg)(),(0,o.iD)("div",H,[(0,o._)("h1",null,(0,i.zw)(c.product.title),1),Y,L,(0,o._)("div",N,(0,i.zw)(c.product.price),1)])):((0,o.wg)(),(0,o.j4)(l,{key:1}))}const q=(0,o._)("h1",null,"Page not found",-1),G=(0,o._)("hr",null,null,-1),J=(0,o.Uk)(" Start from main page "),Q=[q,G,J];function V(t,e,n,r,i,a){return(0,o.wg)(),(0,o.iD)("div",null,Q)}var X={};const tt=(0,g.Z)(X,[["render",V]]);var et=tt,nt={components:{AppE404:et},computed:{...(0,y.Se)("products",{productById:"one"}),id(){return parseInt(this.$route.params.id)},validId(){return/^[1-9]+\d*$/.test(this.id)},product(){return this.productById(this.id)},hasProduct(){return this.validId&&void 0!==this.product}}};const rt=(0,g.Z)(nt,[["render",F]]);var ot=rt;const it=(0,o._)("h1",null,"Cart",-1),at=(0,o._)("hr",null,null,-1),ct={class:"table table-bordered table-hover"},lt=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"Title"),(0,o._)("th",null,"Price"),(0,o._)("th",null,"Cnt"),(0,o._)("th",null,"Total"),(0,o._)("th",null,"Actions")])],-1),st=["onClick"],ut=["onClick"],dt=(0,o._)("hr",null,null,-1),pt=(0,o.Uk)("Checkout");function mt(t,e,n,r,a,c){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[it,at,(0,o._)("table",ct,[lt,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.products,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",null,(0,i.zw)(e.title.trim()),1),(0,o._)("td",null,(0,i.zw)(e.price),1),(0,o._)("td",null,(0,i.zw)(e.cnt),1),(0,o._)("td",null,(0,i.zw)(e.price*e.cnt),1),(0,o._)("td",null,[(0,o._)("button",{class:"btn btn-warning me-1",onClick:n=>t.setCnt({id:e.id,cnt:e.cnt-1})},"-1",8,st),(0,o._)("button",{class:"btn btn-success",onClick:n=>t.setCnt({id:e.id,cnt:e.cnt+1})},"+1",8,ut)])])))),128))])]),dt,(0,o.Wm)(l,{to:{name:"checkout"},class:"btn btn-success"},{default:(0,o.w5)((()=>[pt])),_:1})])}var vt={computed:{...(0,y.Se)("cart",{products:"itemsDetailed"})},methods:{...(0,y.nv)("cart",["setCnt"])}};const ht=(0,g.Z)(vt,[["render",mt]]);var ft=ht;const _t=(0,o._)("h1",null,"Order now",-1),wt=(0,o._)("hr",null,null,-1),kt=[_t,wt];function gt(t,e,n,r,i,a){return(0,o.wg)(),(0,o.iD)("div",null,kt)}var bt={};const Ct=(0,g.Z)(bt,[["render",gt]]);var yt=Ct;const Dt=[{name:"catalog",path:"/",component:B},{name:"cart",path:"/cart",component:ft},{name:"checkout",path:"/order",component:yt},{name:"product",path:"/product/:id",component:ot},{path:"/:any(.*)",component:et}];var Ot=(0,z.p7)({routes:Dt,history:(0,z.PO)()});j.dispatch("products/load").then((()=>{(0,r.ri)(C).use(j).use(Ot).mount("#app")})),j.dispatch("cart/load")}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,r,o,i){if(!r){var a=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],i=t[u][2];for(var c=!0,l=0;l<r.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](r[l])}))?r.splice(l--,1):(c=!1,i<a&&(a=i));if(c){t.splice(u--,1);var s=o();void 0!==s&&(e=s)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[r,o,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,a=r[0],c=r[1],l=r[2],s=0;if(a.some((function(e){return 0!==t[e]}))){for(o in c)n.o(c,o)&&(n.m[o]=c[o]);if(l)var u=l(n)}for(e&&e(r);s<a.length;s++)i=a[s],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},r=self["webpackChunkvue_2022_03"]=self["webpackChunkvue_2022_03"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(8256)}));r=n.O(r)})();
//# sourceMappingURL=app.js.map